# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∏–ø–∞ JSON –¥–ª—è Otterbrix

## –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ—Ç–æ—Ç–∏–ø —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö JSON –¥–ª—è –∫–æ–ª–æ–Ω–æ—á–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Otterbrix.

### –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã —Ö—Ä–∞–Ω–∏—Ç—å JSON –∫–∞–∫ —Å—Ç—Ä–æ–∫—É –∏–ª–∏ –±–∏–Ω–∞—Ä–Ω—ã–π blob, –º—ã —Ö—Ä–∞–Ω–∏–º –µ–≥–æ –≤ **–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ** —Å —Ä–∞–∑–ª–æ–∂–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –≤ –±—É–¥—É—â–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É JSON.

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞

- **–¢–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã–µ JSON –æ–±—ä–µ–∫—Ç—ã** - –±–µ–∑ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (—Ç–æ–ª—å–∫–æ `{"key": value}`)
- **–¢–æ–ª—å–∫–æ INTEGER –∑–Ω–∞—á–µ–Ω–∏—è** - –ø–æ–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- **–¢–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏—è read()** - —Å–±–æ—Ä–∫–∞ JSON –æ–±—Ä–∞—Ç–Ω–æ –≤ —Å—Ç—Ä–æ–∫—É

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã

–î–ª—è –∫–∞–∂–¥–æ–π –∫–æ–ª–æ–Ω–∫–∏ —Ç–∏–ø–∞ JSON —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–∞—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞:

```
–ò–º—è —Ç–∞–±–ª–∏—Ü—ã: __json_<table_name>_<column_name>

–°—Ö–µ–º–∞:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id          ‚îÇ BIGINT   ‚îÇ PRIMARY KEY, –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç              ‚îÇ
‚îÇ json_id     ‚îÇ BIGINT   ‚îÇ NOT NULL, –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä JSON –æ–±—ä–µ–∫—Ç–∞    ‚îÇ
‚îÇ full_path   ‚îÇ VARCHAR  ‚îÇ NOT NULL, –ø—É—Ç—å –∫ –ø–æ–ª—é ("age", "count")  ‚îÇ
‚îÇ int_value   ‚îÇ INTEGER  ‚îÇ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã

**–û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞:**
```sql
CREATE TABLE users (
    id BIGINT,
    name VARCHAR,
    data JSON  -- <- –Ω–∞—à–∞ JSON –∫–æ–ª–æ–Ω–∫–∞
);
```

**–ü—Ä–∏ INSERT:**
```sql
INSERT INTO users VALUES (1, 'Alice', '{"age": 25, "score": 100}');
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏ –≤ `__json_users_data`:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id ‚îÇ json_id ‚îÇ full_path ‚îÇ int_value ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1  ‚îÇ 1       ‚îÇ "age"     ‚îÇ 25        ‚îÇ
‚îÇ 2  ‚îÇ 1       ‚îÇ "score"   ‚îÇ 100       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–í –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ `users` —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ `json_id`:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id ‚îÇ name  ‚îÇ data    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1  ‚îÇ Alice ‚îÇ 1       ‚îÇ  <- —ç—Ç–æ json_id
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–∏ SELECT:**
```sql
SELECT * FROM users WHERE id = 1;
```

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ß–∏—Ç–∞–µ—Ç `json_id = 1` –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
2. –ò—â–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –≤ `__json_users_data` –≥–¥–µ `json_id = 1`
3. –°–æ–±–∏—Ä–∞–µ—Ç –∏—Ö –æ–±—Ä–∞—Ç–Ω–æ –≤ JSON —Å—Ç—Ä–æ–∫—É: `{"age": 25, "score": 100}`

---

## –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

‚úÖ **–§–∞–∑–∞ 1: –°–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤** - –ó–∞–≤–µ—Ä—à–µ–Ω–∞
‚úÖ **–§–∞–∑–∞ 2: JSON Column Data –∫–ª–∞—Å—Å** - –ó–∞–≤–µ—Ä—à–µ–Ω–∞
‚úÖ **–§–∞–∑–∞ 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º—É –∫–æ–ª–æ–Ω–æ–∫** - –ó–∞–≤–µ—Ä—à–µ–Ω–∞
‚úÖ **–§–∞–∑–∞ 4: In-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - –ó–∞–≤–µ—Ä—à–µ–Ω–∞
‚úÖ **–§–∞–∑–∞ 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è INSERT (append_data)** - –ó–∞–≤–µ—Ä—à–µ–Ω–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
‚úÖ **–§–∞–∑–∞ 6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SELECT (scan)** - –ó–∞–≤–µ—Ä—à–µ–Ω–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
‚úÖ **–§–∞–∑–∞ 7: –ë–∞–∑–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ó–∞–≤–µ—Ä—à–µ–Ω–∞
‚úÖ **–§–∞–∑–∞ 8: –¢–µ—Å—Ç—ã JSON –∫–æ–ª–æ–Ω–∫–∏** - –ó–∞–≤–µ—Ä—à–µ–Ω–∞ (**324 assertions passed!**)

---

## –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ç–∏–ø JSON

**–§–∞–π–ª:** `components/types/types.hpp`

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ 1: –î–æ–±–∞–≤–ª–µ–Ω enum –¥–ª—è JSON —Ç–∏–ø–∞

```cpp
enum class logical_type : uint8_t
{
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∏–ø—ã ...
    UNION = 107,
    ARRAY = 108,
    JSON = 109,  // <- –î–û–ë–ê–í–õ–ï–ù–û: –Ω–æ–≤—ã–π —Ç–∏–ø JSON

    UNKNOWN = 127,
    INVALID = 255
};
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `enum class` - —ç—Ç–æ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ (—Å–ø–∏—Å–æ–∫ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)
- `logical_type` - —ç—Ç–æ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —Ç–∏–ø, –∫–æ—Ç–æ—Ä—ã–π –≤–∏–¥—è—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- –ú—ã –¥–æ–±–∞–≤–∏–ª–∏ –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `JSON = 109`
- –ö–∞–∂–¥—ã–π —Ç–∏–ø –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ 2: –î–æ–±–∞–≤–ª–µ–Ω extension_type –¥–ª—è JSON

```cpp
class logical_type_extension {
public:
    enum class extension_type : uint8_t
    {
        // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∏–ø—ã ...
        FUNCTION = 8,
        JSON = 9  // <- –î–û–ë–ê–í–õ–ï–ù–û
    };
    // ...
};
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –°–ª–æ–∂–Ω—ã–µ —Ç–∏–ø—ã (struct, array, map, json) –∏–º–µ—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- `extension_type` —É–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ —Å–ª–æ–∂–Ω—ã–π —Ç–∏–ø –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–∞

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ 3: –°–æ–∑–¥–∞–Ω –∫–ª–∞—Å—Å json_logical_type_extension

```cpp
class json_logical_type_extension : public logical_type_extension {
public:
    json_logical_type_extension();
    explicit json_logical_type_extension(std::string auxiliary_table_name);

    const std::string& auxiliary_table_name() const noexcept { return auxiliary_table_name_; }
    void set_auxiliary_table_name(const std::string& name) { auxiliary_table_name_ = name; }

private:
    std::string auxiliary_table_name_;  // –ò–º—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
};
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `class ... : public logical_type_extension` - –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞
- `explicit` - –∑–∞–ø—Ä–µ—â–∞–µ—Ç –Ω–µ—è–≤–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤ (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- `const noexcept` - –º–µ—Ç–æ–¥ –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç –æ–±—ä–µ–∫—Ç –∏ –Ω–µ –±—Ä–æ—Å–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- `auxiliary_table_name_` - —Ö—Ä–∞–Ω–∏—Ç –∏–º—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `__json_users_data`)

**–ó–∞—á–µ–º –Ω—É–∂–µ–Ω —ç—Ç–æ—Ç –∫–ª–∞—Å—Å:**
- –•—Ä–∞–Ω–∏—Ç –∏–º—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –¥–∞–Ω–Ω–æ–π JSON –∫–æ–ª–æ–Ω–∫–∏
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–µ –∑–Ω–∞—Ç—å, –≥–¥–µ –∏—Å–∫–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —ç—Ç–æ–≥–æ JSON –ø–æ–ª—è

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ 4: –î–æ–±–∞–≤–ª–µ–Ω —Ñ–∞–±—Ä–∏—á–Ω—ã–π –º–µ—Ç–æ–¥ create_json

```cpp
class complex_logical_type {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã ...

    static complex_logical_type create_json(
        std::string auxiliary_table_name = "",
        std::string alias = ""
    );
};
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `static` - –º–µ—Ç–æ–¥ –∫–ª–∞—Å—Å–∞, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞
- –§–∞–±—Ä–∏—á–Ω—ã–π –º–µ—Ç–æ–¥ - —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`= ""`) –¥–µ–ª–∞—é—Ç –∏—Ö –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
```cpp
// –°–æ–∑–¥–∞—Ç—å JSON —Ç–∏–ø
auto json_type = complex_logical_type::create_json("__json_users_data");
```

### 2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ types.cpp

**–§–∞–π–ª:** `components/types/types.cpp`

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ 1: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è JSON —Ç–∏–ø–æ–≤

```cpp
complex_logical_type::complex_logical_type(const complex_logical_type& other)
    : type_(other.type_) {
    if (other.extension_) {
        switch (other.extension_->type()) {
            // ... –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã ...
            case logical_type_extension::extension_type::JSON:
                extension_ = std::make_unique<json_logical_type_extension>(
                    *static_cast<json_logical_type_extension*>(other.extension_.get())
                );
                break;
            // ...
        }
    }
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞
- `std::make_unique` - —Å–æ–∑–¥–∞–µ—Ç —É–º–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é)
- `static_cast` - –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–∞ (–≥–æ–≤–æ—Ä–∏–º –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É, —á—Ç–æ —ç—Ç–æ –∏–º–µ–Ω–Ω–æ json_logical_type_extension)
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –∫–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω –≤ `operator=` (–æ–ø–µ—Ä–∞—Ç–æ—Ä –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è)

**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ:**
- –í C++ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø–æ–ª—è
- –ë–µ–∑ —ç—Ç–æ–≥–æ –∫–æ–¥–∞ extension –Ω–µ —Å–∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ 2: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Ç–∏–ø

```cpp
physical_type complex_logical_type::to_physical_type() const {
    switch (type_) {
        // ... –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã ...
        case logical_type::JSON:
            return physical_type::INT64;  // JSON —Ö—Ä–∞–Ω–∏—Ç json_id –∫–∞–∫ BIGINT
        // ...
    }
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –õ–æ–≥–∏—á–µ—Å–∫–∏–π —Ç–∏–ø - —ç—Ç–æ —Ç–æ, —á—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (JSON)
- –§–∏–∑–∏—á–µ—Å–∫–∏–π —Ç–∏–ø - —ç—Ç–æ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ –¥–∏—Å–∫–µ (INT64)
- JSON –∫–æ–ª–æ–Ω–∫–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ `json_id` (64-–±–∏—Ç–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ)
- –ù–∞—Å—Ç–æ—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ JSON –ª–µ–∂–∞—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ 3: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞–±—Ä–∏—á–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞

```cpp
complex_logical_type complex_logical_type::create_json(
    std::string auxiliary_table_name,
    std::string alias
) {
    return complex_logical_type(
        logical_type::JSON,
        std::make_unique<json_logical_type_extension>(std::move(auxiliary_table_name)),
        std::move(alias)
    );
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `std::move` - –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
- –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç —Ç–∏–ø–∞ `complex_logical_type` —Å JSON —Ç–∏–ø–æ–º –∏ extension

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ 4: –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã json_logical_type_extension

```cpp
json_logical_type_extension::json_logical_type_extension()
    : logical_type_extension(extension_type::JSON)
    , auxiliary_table_name_() {}

json_logical_type_extension::json_logical_type_extension(std::string auxiliary_table_name)
    : logical_type_extension(extension_type::JSON)
    , auxiliary_table_name_(std::move(auxiliary_table_name)) {}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `: logical_type_extension(extension_type::JSON)` - –≤—ã–∑–æ–≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞
- `, auxiliary_table_name_()` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–µ–π –∫–ª–∞—Å—Å–∞
- –î–≤–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞: –æ–¥–∏–Ω –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –¥—Ä—É–≥–æ–π —Å –∏–º–µ–Ω–µ–º —Ç–∞–±–ª–∏—Ü—ã

---

## –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. components/types/types.hpp

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ `JSON = 109` –≤ enum `logical_type`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ `JSON = 9` –≤ enum `extension_type`
- –î–æ–±–∞–≤–ª–µ–Ω –∫–ª–∞—Å—Å `json_logical_type_extension`
- –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `create_json()` –≤ –∫–ª–∞—Å—Å `complex_logical_type`

**–°—Ç—Ä–æ–∫–∏:**
- –°—Ç—Ä–æ–∫–∞ 121: –¥–æ–±–∞–≤–ª–µ–Ω `JSON = 109`
- –°—Ç—Ä–æ–∫–∞ 452: –¥–æ–±–∞–≤–ª–µ–Ω `JSON = 9` –≤ extension_type
- –°—Ç—Ä–æ–∫–∏ 575-585: –¥–æ–±–∞–≤–ª–µ–Ω –∫–ª–∞—Å—Å `json_logical_type_extension`
- –°—Ç—Ä–æ–∫–∞ 405: –¥–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `create_json()`

### 2. components/types/types.cpp

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è JSON —Ç–∏–ø–æ–≤ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è JSON —Ç–∏–ø–æ–≤ –≤ operator=
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ JSON ‚Üí INT64 –≤ `to_physical_type()`
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `create_json()`
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã `json_logical_type_extension`

**–°—Ç—Ä–æ–∫–∏:**
- –°—Ç—Ä–æ–∫–∏ 64-67: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –°—Ç—Ä–æ–∫–∏ 113-116: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ operator=
- –°—Ç—Ä–æ–∫–∏ 271-272: –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Ç–∏–ø
- –°—Ç—Ä–æ–∫–∏ 386-389: —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è create_json()
- –°—Ç—Ä–æ–∫–∏ 479-485: –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã json_logical_type_extension

### 3. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–ª–∞—Å—Å json_column_data_t

**–§–∞–π–ª—ã:** `components/table/json_column_data.hpp` –∏ `components/table/json_column_data.cpp`

#### –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

**json_column_data.hpp:**
- –°–æ–∑–¥–∞–Ω –∫–ª–∞—Å—Å `json_column_data_t`, –Ω–∞—Å–ª–µ–¥—É—é—â–∏–π –æ—Ç `column_data_t`
- –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `read_json(int64_t json_id)` –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è JSON –∏–∑ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
  - `parse_simple_json()` - –ø–∞—Ä—Å–∏–Ω–≥ –ø—Ä–æ—Å—Ç—ã—Ö JSON –æ–±—ä–µ–∫—Ç–æ–≤
  - `insert_into_auxiliary_table()` - –≤—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
  - `query_auxiliary_table()` - –∑–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è:
  - `auxiliary_table_name_` - –∏–º—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
  - `next_json_id_` - —Å—á–µ—Ç—á–∏–∫ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö json_id
  - `validity` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ NULL –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

**json_column_data.cpp:**
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–º—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –∏–∑ extension
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –º–µ—Ç–æ–¥—ã scan, append, update —Å –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∫ –±–∞–∑–æ–≤–æ–º—É –∫–ª–∞—Å—Å—É
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `parse_simple_json()`:**
  - –£–¥–∞–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã –∏–∑ JSON —Å—Ç—Ä–æ–∫–∏
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç `{...}`
  - –†–∞–∑–±–∏—Ä–∞–µ—Ç –ø–∞—Ä—ã –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ
  - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
  - –ü—Ä–∏–º–µ—Ä: `{"age": 25, "score": 100}` ‚Üí `map{"age" ‚Üí 25, "score" ‚Üí 100}`
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `read_json()`:**
  - –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –ø–æ json_id
  - –°–æ–±–∏—Ä–∞–µ—Ç JSON —Å—Ç—Ä–æ–∫—É –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π
  - –ü—Ä–∏–º–µ—Ä: `map{"age" ‚Üí 25, "score" ‚Üí 100}` ‚Üí `{"age": 25, "score": 100}`
- –î–æ–±–∞–≤–ª–µ–Ω—ã TODO –¥–ª—è –º–µ—Ç–æ–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏:
  - `insert_into_auxiliary_table()` - —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü
  - `query_auxiliary_table()` - —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –°–ª–µ–¥—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—É `standard_column_data_t`
- –î–µ–ª–µ–≥–∏—Ä—É–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –±–∞–∑–æ–≤–æ–º—É –∫–ª–∞—Å—Å—É `column_data_t`
- –£–ø—Ä–∞–≤–ª—è–µ—Ç validity –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ NULL –∑–Ω–∞—á–µ–Ω–∏–π
- –§–∏–∑–∏—á–µ—Å–∫–∏ —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ `json_id` (–∫–∞–∫ INT64) –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–ª–æ–Ω–∫–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `std::atomic<int64_t>` –¥–ª—è –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ json_id

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º—É –∫–æ–ª–æ–Ω–æ–∫

**–§–∞–π–ª:** `components/table/column_data.cpp`

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- –î–æ–±–∞–≤–ª–µ–Ω `#include "json_column_data.hpp"` (—Å—Ç—Ä–æ–∫–∞ 7)
- –î–æ–±–∞–≤–ª–µ–Ω case –≤ –º–µ—Ç–æ–¥ `create_column()` (—Å—Ç—Ä–æ–∫–∏ 361-367):
  ```cpp
  } else if (type.type() == types::logical_type::JSON) {
      return std::make_unique<json_column_data_t>(resource,
                                                  block_manager,
                                                  column_index,
                                                  start_row,
                                                  type,
                                                  parent);
  ```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ç–∏–ø (`type.type()`) –≤–º–µ—Å—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ (`to_physical_type()`)
- –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ JSON —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ INT64
- –ù–æ –º—ã —Ö–æ—Ç–∏–º —Å–æ–∑–¥–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π `json_column_data_t`, –∞ –Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π INT64

### 5. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

**–§–∞–π–ª:** `components/table/CMakeLists.txt`

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- –î–æ–±–∞–≤–ª–µ–Ω `json_column_data.cpp` –≤ —Å–ø–∏—Å–æ–∫ `SOURCE_${PROJECT_NAME}` (—Å—Ç—Ä–æ–∫–∞ 8)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
‚úÖ –ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è
‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

---

## –ù–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (In-Memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)

### –û–±–∑–æ—Ä –ø–æ–¥—Ö–æ–¥–∞

–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞ –º—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö JSON –≤–Ω—É—Ç—Ä–∏ `json_column_data_t`, –≤–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å —Ü–∏–∫–ª INSERT/SELECT —Å JSON –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å catalog –∏ —Å–∏—Å—Ç–µ–º–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü–∞–º–∏.

### –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

#### 1. In-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤ json_column_data.hpp

```cpp
// In-memory storage for auxiliary table data (prototype implementation)
// Maps json_id -> (key -> value)
// In production, this would be replaced with actual table storage
std::unordered_map<int64_t, std::map<std::string, int64_t>> auxiliary_data_;

// Mutex to protect auxiliary_data_ from concurrent access
mutable std::mutex auxiliary_data_mutex_;
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `auxiliary_data_` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ `json_id` –Ω–∞ map –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ
- –í production —ç—Ç–æ –±—É–¥–µ—Ç –∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
- –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—è `auxiliary_data_mutex_`

#### 2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è insert_into_auxiliary_table()

```cpp
void json_column_data_t::insert_into_auxiliary_table(int64_t json_id,
                                                     const std::map<std::string, int64_t>& fields) {
    // Thread-safe insertion into in-memory storage
    std::lock_guard<std::mutex> lock(auxiliary_data_mutex_);
    auxiliary_data_[json_id] = fields;
}
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ë–µ—Ä–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –¥–ª—è –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª—è JSON –≤ –ø–∞–º—è—Ç–∏
- –í production –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å INSERT –≤ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É

#### 3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è query_auxiliary_table()

```cpp
std::map<std::string, int64_t> json_column_data_t::query_auxiliary_table(int64_t json_id) {
    std::lock_guard<std::mutex> lock(auxiliary_data_mutex_);

    auto it = auxiliary_data_.find(json_id);
    if (it != auxiliary_data_.end()) {
        return it->second;
    }

    return std::map<std::string, int64_t>();
}
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ë–µ—Ä–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
- –ò—â–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ json_id
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π map, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
- –í production –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å SELECT –∏–∑ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã

#### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ append_data()

**–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª INSERT:**
1. –ü–æ–ª—É—á–∞–µ–º JSON —Å—Ç—Ä–æ–∫–∏ –∏–∑ `unified_vector_format` –∫–∞–∫ `std::string_view`
2. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏:
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `json_id`
   - –ü–∞—Ä—Å–∏–º JSON –≤ map –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ
   - –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ `auxiliary_data_`
   - –ó–∞–º–µ–Ω—è–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ `json_id` (INT64)
3. –ü–µ—Ä–µ–¥–∞–µ–º `json_id` –≤ –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è

```cpp
// Get the string data from unified format
auto string_data = uvf.get_data<std::string_view>();

// Process each JSON string
for (uint64_t i = 0; i < count; i++) {
    std::string json_string(string_data[idx]);

    int64_t json_id = next_json_id_.fetch_add(1);  // Thread-safe
    auto fields = parse_simple_json(json_string);
    insert_into_auxiliary_table(json_id, fields);

    json_ids[i] = json_id;
}

// Append json_ids as INT64
column_data_t::append_data(state, json_id_format, count);
```

#### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ scan()

**–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª SELECT:**
1. –°–∫–∞–Ω–∏—Ä—É–µ–º `json_id` (INT64) –∏–∑ –±–∞–∑–æ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ `json_id`:
   - –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–ª—è –∏–∑ `auxiliary_data_`
   - –°–æ–±–∏—Ä–∞–µ–º JSON —Å—Ç—Ä–æ–∫—É —Å –ø–æ–º–æ—â—å—é `read_json()`
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –≤–µ–∫—Ç–æ—Ä

```cpp
// Scan json_ids into temp vector
vector::vector_t temp_vector(resource_,
    types::complex_logical_type(types::logical_type::BIGINT),
    target_count);

auto scan_count = column_data_t::scan(vector_index, state, temp_vector, target_count);

// Convert json_ids to JSON strings
for (uint64_t i = 0; i < scan_count; i++) {
    int64_t json_id = *temp_vector.value(i).value<int64_t*>();
    std::string json_str = read_json(json_id);
    result.set_value(i, types::logical_value_t{json_str});
}
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞

‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å catalog
‚úÖ **–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–µ—Å—å —Ü–∏–∫–ª INSERT/SELECT
‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å
‚úÖ **–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç mutex –¥–ª—è –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö
‚úÖ **–õ–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å** - —á–µ—Ç–∫–∞—è —Ç–æ—á–∫–∞ –¥–ª—è –±—É–¥—É—â–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

‚ö†Ô∏è **–¢–æ–ª—å–∫–æ –≤ –ø–∞–º—è—Ç–∏** - –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ –¥–∏—Å–∫
‚ö†Ô∏è **–ù–µ—Ç –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏** - –¥–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
‚ö†Ô∏è **–ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** - –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å MVCC
‚ö†Ô∏è **–ü—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–µ—Ä** - —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã–µ JSON –æ–±—ä–µ–∫—Ç—ã —Å INTEGER –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

### –ü—É—Ç—å –∫ production

–î–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ production –≤–µ—Ä—Å–∏–∏ –Ω—É–∂–Ω–æ:

1. **–°–æ–∑–¥–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É** –ø—Ä–∏ CREATE TABLE —Å JSON –∫–æ–ª–æ–Ω–∫–æ–π
2. **–ó–∞–º–µ–Ω–∏—Ç—å `auxiliary_data_`** –Ω–∞ –≤—ã–∑–æ–≤—ã `data_table_t` –º–µ—Ç–æ–¥–æ–≤
3. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å catalog** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏
4. **–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å** - MVCC –¥–ª—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
5. **–†–∞—Å—à–∏—Ä–∏—Ç—å –ø–∞—Ä—Å–µ—Ä** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤, —Å—Ç—Ä–æ–∫, —á–∏—Å–µ–ª —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π

---

## –ß—Ç–æ –¥–∞–ª—å—à–µ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### 1. ~~–°–æ–∑–¥–∞—Ç—å JSON Column Data –∫–ª–∞—Å—Å~~ ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–ö–ª–∞—Å—Å `json_column_data_t` —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ —Å–∏—Å—Ç–µ–º—É.

### 2. ~~–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ column_data.cpp~~ ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

JSON —Ç–∏–ø —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ –º–µ—Ç–æ–¥–µ `create_column()`.

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã (–°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì)

**–ì–¥–µ:** –í catalog –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –∏–ª–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü—ã

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ü—Ä–∏ CREATE TABLE —Å JSON –∫–æ–ª–æ–Ω–∫–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
- –ü—Ä–∏ DROP TABLE —É–¥–∞–ª—è—Ç—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
- –†–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–≤—è–∑—å –º–µ–∂–¥—É –æ—Å–Ω–æ–≤–Ω–æ–π –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π

**–°—Ö–µ–º–∞ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã:**
```cpp
auto create_json_auxiliary_table(
    const std::string& main_table_name,
    const std::string& column_name
) {
    std::string aux_table_name = "__json_" + main_table_name + "_" + column_name;

    // –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
    // - id BIGINT PRIMARY KEY
    // - json_id BIGINT NOT NULL
    // - full_path VARCHAR NOT NULL
    // - int_value INTEGER

    return aux_table_name;
}
```

### 4. ~~–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ read_json()~~ ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–§—É–Ω–∫—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `json_column_data.cpp`:
- –í—ã–∑—ã–≤–∞–µ—Ç `query_auxiliary_table()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–µ–π
- –°–æ–±–∏—Ä–∞–µ—Ç JSON —Å—Ç—Ä–æ–∫—É –∏–∑ map —Å –∫–ª—é—á–∞–º–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç JSON —Å –∫–∞–≤—ã—á–∫–∞–º–∏ –∏ –∑–∞–ø—è—Ç—ã–º–∏

### 5. ~~–ü–∞—Ä—Å–∏–Ω–≥ JSON –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ~~ ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–§—É–Ω–∫—Ü–∏—è `parse_simple_json()` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `json_column_data.cpp`:
- –£–¥–∞–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã –∏–∑ JSON —Å—Ç—Ä–æ–∫–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç–∞ `{...}`
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –ø–∞—Ä—ã –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –ø–æ–∏—Å–∫–∞ –∫–∞–≤—ã—á–µ–∫ –∏ –¥–≤–æ–µ—Ç–æ—á–∏–π
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `std::map<std::string, int64_t>`

---

## –î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     CREATE TABLE users                          ‚îÇ
‚îÇ                     (id BIGINT, data JSON)                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                             ‚ñº
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ –°–æ–∑–¥–∞–µ—Ç—Å—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞:     ‚îÇ
        ‚îÇ __json_users_data                      ‚îÇ
        ‚îÇ (id, json_id, full_path, int_value)    ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         INSERT INTO users VALUES (1, '{"age": 25}')            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                             ‚ñº
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è json_id = 1            ‚îÇ
        ‚îÇ 2. JSON –ø–∞—Ä—Å–∏—Ç—Å—è: {"age": 25}          ‚îÇ
        ‚îÇ 3. –í—Å—Ç–∞–≤–∫–∞ –≤ __json_users_data:        ‚îÇ
        ‚îÇ    (1, 1, "age", 25)                   ‚îÇ
        ‚îÇ 4. –í—Å—Ç–∞–≤–∫–∞ –≤ users:                    ‚îÇ
        ‚îÇ    (id=1, data=1)  <- —ç—Ç–æ json_id      ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              SELECT data FROM users WHERE id = 1                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                             ‚ñº
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ 1. –ß–∏—Ç–∞–µ–º json_id = 1 –∏–∑ users         ‚îÇ
        ‚îÇ 2. –ó–∞–ø—Ä–æ—Å –∫ __json_users_data:         ‚îÇ
        ‚îÇ    WHERE json_id = 1                   ‚îÇ
        ‚îÇ 3. –ü–æ–ª—É—á–∞–µ–º: [("age", 25)]             ‚îÇ
        ‚îÇ 4. –°–æ–±–∏—Ä–∞–µ–º JSON: {"age": 25}          ‚îÇ
        ‚îÇ 5. –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é      ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å JSON

```sql
CREATE TABLE products (
    id BIGINT,
    name VARCHAR,
    metadata JSON  -- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç __json_products_metadata
);
```

### –í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```sql
INSERT INTO products VALUES
    (1, 'Laptop', '{"price": 1000, "stock": 50}'),
    (2, 'Mouse', '{"price": 25, "stock": 200}');
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏:**

–û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `products`:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id ‚îÇ name   ‚îÇ metadata ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1  ‚îÇ Laptop ‚îÇ 1        ‚îÇ
‚îÇ 2  ‚îÇ Mouse  ‚îÇ 2        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `__json_products_metadata`:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id ‚îÇ json_id ‚îÇ full_path ‚îÇ int_value ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1  ‚îÇ 1       ‚îÇ price     ‚îÇ 1000      ‚îÇ
‚îÇ 2  ‚îÇ 1       ‚îÇ stock     ‚îÇ 50        ‚îÇ
‚îÇ 3  ‚îÇ 2       ‚îÇ price     ‚îÇ 25        ‚îÇ
‚îÇ 4  ‚îÇ 2       ‚îÇ stock     ‚îÇ 200       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```sql
SELECT * FROM products WHERE id = 1;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
id: 1
name: Laptop
metadata: {"price": 1000, "stock": 50}
```

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### 1. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É JSON (–≤ –±—É–¥—É—â–µ–º)

–ü–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å:
```sql
-- –ù–∞–π—Ç–∏ –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã —Å —Ü–µ–Ω–æ–π > 100
SELECT * FROM products
WHERE json_extract(metadata, 'price') > 100;
```

–≠—Ç–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—Å—è –≤:
```sql
SELECT p.* FROM products p
JOIN __json_products_metadata m ON p.metadata = m.json_id
WHERE m.full_path = 'price' AND m.int_value > 100;
```

### 2. –ö–æ–ª–æ–Ω–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è JSON

- –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª—è `price` –ª–µ–∂–∞—Ç –≤ –æ–¥–Ω–æ–π –∫–æ–ª–æ–Ω–∫–µ - —Ö–æ—Ä–æ—à–æ —Å–∂–∏–º–∞—é—Ç—Å—è
- –ú–æ–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ JSON –ø–æ–ª—è
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è

### 3. –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å

–õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤:
```sql
ALTER TABLE __json_products_metadata
ADD COLUMN string_value VARCHAR,
ADD COLUMN double_value DOUBLE,
ADD COLUMN bool_value BOOLEAN;
```

---

## –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### 1. –ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã

- –ö–∞–∂–¥–∞—è JSON –∫–æ–ª–æ–Ω–∫–∞ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
- JOIN –ø—Ä–∏ –∫–∞–∂–¥–æ–º SELECT –¥–ª—è —Å–±–æ—Ä–∫–∏ JSON
- –ë–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ

### 2. –°–ª–æ–∂–Ω–æ—Å—Ç—å UPDATE

–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ JSON –Ω—É–∂–Ω–æ:
1. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
2. –í—Å—Ç–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏
3. –û–±–Ω–æ–≤–∏—Ç—å json_id (–∏–ª–∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π)

### 3. –ü—Ä–æ—Ç–æ—Ç–∏–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω

- –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã–µ JSON –æ–±—ä–µ–∫—Ç—ã
- –¢–æ–ª—å–∫–æ INTEGER –∑–Ω–∞—á–µ–Ω–∏—è
- –ù–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞

1. ~~**–°–æ–∑–¥–∞—Ç—å json_column_data_t –∫–ª–∞—Å—Å**~~ ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**
   - ‚úÖ –ù–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å –æ—Ç column_data_t
   - ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å append() –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏
   - ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å read_json() –¥–ª—è —á—Ç–µ–Ω–∏—è

2. ~~**–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–π JSON –ø–∞—Ä—Å–µ—Ä**~~ ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**
   - ‚úÖ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç {"key": value, ...}
   - ‚úÖ –ò–∑–≤–ª–µ–∫–∞—Ç—å –ø–∞—Ä—ã –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è - —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞

3. ~~**–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ column_data.cpp**~~ ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**
   - ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤ create_column()
   - ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å JSON —Ç–∏–ø

4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô - —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥)
   - ‚è≥ –ü—Ä–∏ CREATE TABLE —Å JSON –∫–æ–ª–æ–Ω–∫–æ–π
   - ‚è≥ –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–º—è —Ç–∞–±–ª–∏—Ü—ã
   - ‚è≥ –°–æ–∑–¥–∞–≤–∞—Ç—å —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ö–µ–º–æ–π

5. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô)
   - ‚è≥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å insert_into_auxiliary_table()
   - ‚è≥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å query_auxiliary_table()
   - ‚è≥ –û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

6. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: —Å—Ä–µ–¥–Ω–∏–π)
   - ‚è≥ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è json_column_data_t
   - ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å INSERT/SELECT
   - ‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å–±–æ—Ä–∫–∏ JSON

---

## –ì–ª–æ—Å—Å–∞—Ä–∏–π —Ç–µ—Ä–º–∏–Ω–æ–≤

**–õ–æ–≥–∏—á–µ—Å–∫–∏–π —Ç–∏–ø (logical_type)** - —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (JSON, INTEGER, VARCHAR)

**–§–∏–∑–∏—á–µ—Å–∫–∏–π —Ç–∏–ø (physical_type)** - –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–∞ –¥–∏—Å–∫–µ (INT64, STRING)

**Extension** - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ç–∏–ø–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–º—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è JSON)

**Column data** - –∫–ª–∞—Å—Å, —É–ø—Ä–∞–≤–ª—è—é—â–∏–π —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –æ–¥–Ω–æ–π –∫–æ–ª–æ–Ω–∫–∏

**json_id** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä JSON –æ–±—ä–µ–∫—Ç–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –≤—Å–µ –µ–≥–æ –ø–æ–ª—è —Å–≤—è–∑–∞–Ω—ã –≤–æ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ

**–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (auxiliary table)** - –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ JSON –≤ —Ä–∞–∑–ª–æ–∂–µ–Ω–Ω–æ–º –≤–∏–¥–µ

**Smart pointer (std::unique_ptr)** - —É–º–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å –≤ C++, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–∞–º—è—Ç—å

**Factory method (—Ñ–∞–±—Ä–∏—á–Ω—ã–π –º–µ—Ç–æ–¥)** - –º–µ—Ç–æ–¥ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, create_json())

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú—ã —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ –ø–æ–ª–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ JSON —Ç–∏–ø–∞ –≤ Otterbrix:

### –§–∞–∑–∞ 1: –°–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤ ‚úÖ
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ç–∏–ø JSON (logical_type::JSON = 109)
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω extension –∫–ª–∞—Å—Å json_logical_type_extension
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ JSON ‚Üí INT64 (–¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è json_id)
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–µ—Ç–æ–¥—ã –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–æ–∑–¥–∞–Ω–∏—è
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ñ–∞–±—Ä–∏—á–Ω—ã–π –º–µ—Ç–æ–¥ create_json()

### –§–∞–∑–∞ 2: JSON Column Data –∫–ª–∞—Å—Å ‚úÖ
‚úÖ –°–æ–∑–¥–∞–Ω –∫–ª–∞—Å—Å json_column_data_t, –Ω–∞—Å–ª–µ–¥—É—é—â–∏–π –æ—Ç column_data_t
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–µ—Ä JSON (parse_simple_json)
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è JSON (read_json)
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ validity –¥–ª—è NULL –∑–Ω–∞—á–µ–Ω–∏–π
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è json_id

### –§–∞–∑–∞ 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚úÖ
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ —Å–∏—Å—Ç–µ–º—É —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ (column_data.cpp)
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º—É —Å–±–æ—Ä–∫–∏ (CMakeLists.txt)
‚úÖ –ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ üîÑ
–î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –ø—Ä–∏ CREATE TABLE
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã insert_into_auxiliary_table() –∏ query_auxiliary_table()
3. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å catalog –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏
4. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã
