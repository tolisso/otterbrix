# JSONBench: –ü—Ä–æ–±–ª–µ–º–∞ —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏

## –î–∞—Ç–∞: 08.12.2025
## –ü—Ä–æ–±–ª–µ–º–∞: document storage –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –≤–ª–æ–∂–µ–Ω–Ω—ã–º –ø–æ–ª—è–º –≤ WHERE

---

## üêõ –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. Query 1 (GROUP BY): –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–ó–∞–ø—Ä–æ—Å:**
```sql
SELECT "commit.collection" AS event, COUNT(*) AS count 
FROM bluesky_bench.bluesky 
GROUP BY event 
ORDER BY count DESC;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- **document_table**: ‚úÖ 1 group (–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –µ—Å—Ç—å NULL –¥–ª—è –∑–∞–ø–∏—Å–µ–π –±–µ–∑ commit.collection)
- **document (B-tree)**: ‚ùå 0 groups (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ –¥–∞–Ω–Ω—ã–µ)

**–ü—Ä–æ–±–ª–µ–º–∞:** document storage –Ω–µ –º–æ–∂–µ—Ç –∏–∑–≤–ª–µ—á—å –≤–ª–æ–∂–µ–Ω–Ω–æ–µ –ø–æ–ª–µ `"commit.collection"`, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

### 2. Query 3 (WHERE —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º –ø–æ–ª–µ–º): SIGABRT

**–ó–∞–ø—Ä–æ—Å:**
```sql
SELECT * FROM bluesky_bench.bluesky 
WHERE kind = 'commit' AND "commit.operation" = 'create';
```

**–û—à–∏–±–∫–∞:**
```
test_otterbrix: /home/tolisso/.conan2/p/boostda051c0c10648/p/include/boost/smart_ptr/intrusive_ptr.hpp:160: 
T* boost::intrusive_ptr<T>::operator->() const [with T = components::document::document_t]: 
Assertion `px != 0' failed.
SIGABRT - Abort (abnormal termination) signal
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- **document_table**: ‚ùå ABORT (–ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)
- **document (B-tree)**: ‚ùå ABORT (–ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –≤–ª–æ–∂–µ–Ω–Ω–æ–º—É –ø–æ–ª—é `"commit.operation"` —Å–∏—Å—Ç–µ–º–∞ –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –¥–æ–∫—É–º–µ–Ω—Ç—É —á–µ—Ä–µ–∑ `intrusive_ptr`, –Ω–æ –ø–æ–ª—É—á–∞–µ—Ç **nullptr**.

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –†–µ–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ JSON (–∏–∑ test_sample_1000.json):

```json
{
  "did": "did:plc:yj3sjq3blzpynh27cumnp5ks",
  "time_us": 1732206349000167,
  "kind": "commit",
  "commit": {
    "rev": "3lbhtytnn2k2f",
    "operation": "create",
    "collection": "app.bsky.feed.post",
    "rkey": "3lbhtyteurk2y",
    "record": {...},
    "cid": "bafyreidblutgvj75o4q4akzyyejedjj6l3it6hgqwee6jpwv2wqph5fsgm"
  }
}
```

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- ‚úÖ –ü–æ–ª–µ `commit` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∫–∞–∫ –≤–ª–æ–∂–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç
- ‚úÖ –í–Ω—É—Ç—Ä–∏ `commit` –µ—Å—Ç—å `operation` –∏ `collection`
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã, –ø—Ä–æ–±–ª–µ–º–∞ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ

---

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

**document (B-tree) storage:**
1. –•—Ä–∞–Ω–∏—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –∫–∞–∫ —Ü–µ–ª—ã–µ JSON –æ–±—ä–µ–∫—Ç—ã
2. **–ù–ï –∏–∑–≤–ª–µ–∫–∞–µ—Ç** –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. SQL –∑–∞–ø—Ä–æ—Å—ã —Å `"commit.operation"` –Ω–µ –º–æ–≥—É—Ç –Ω–∞–π—Ç–∏ –¥–∞–Ω–Ω—ã–µ
4. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–º –ø–æ–ª—è–º –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ nullptr

**document_table storage:**
1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –≤—Å–µ JSON paths –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ
2. –°–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π
3. `commit.operation` ‚Üí —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∫–æ–ª–æ–Ω–∫–æ–π `"commit.operation"`
4. **–ù–æ —Ç–∞–∫–∂–µ –ø–∞–¥–∞–µ—Ç** –ø—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–¥—Ä—É–≥–∞—è –ø—Ä–æ–±–ª–µ–º–∞)

### –ü–æ—á–µ–º—É document_table —Ç–æ–∂–µ –ø–∞–¥–∞–µ—Ç?

–ü–æ—Ö–æ–∂–µ, –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ document storage, –Ω–æ –∏ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ –≤ executor'–µ. –ö–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–∞ –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä `"commit.operation" = 'create'`, –æ–Ω–∞ –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

## üìã –¢–∞–±–ª–∏—Ü–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

| Query | –ü–æ–ª—è | document (B-tree) | document_table | –°—Ç–∞—Ç—É—Å |
|-------|------|-------------------|----------------|---------|
| **Q0** | INSERT | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ OK |
| **Q1** | `"commit.collection"` (GROUP) | ‚ùå 0 groups | ‚úÖ 1 group | ‚ö†Ô∏è document –æ—à–∏–±–∫–∞ |
| **Q2** | `"commit.operation"`, DISTINCT | ‚ùå –ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ | ‚ùå –ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ | ‚ö†Ô∏è –°–ª–æ–∂–Ω—ã–π |
| **Q3** | `"commit.operation"` (WHERE) | ‚ùå ABORT | ‚ùå ABORT | ‚ùå CRASH |
| **Q4** | `did`, `kind` (–ø—Ä–æ—Å—Ç—ã–µ –ø–æ–ª—è) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ OK |
| **Q5** | `did`, `time_us`, `kind` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ OK |

**–í—ã–≤–æ–¥:** 
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –ø–æ–ª—è (—É—Ä–æ–≤–µ–Ω—å 0): **–æ–±–∞ storage —Ä–∞–±–æ—Ç–∞—é—Ç**
- ‚ùå –í–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–ª—è (—É—Ä–æ–≤–µ–Ω—å 1+): **–æ–±–∞ storage –∏–º–µ—é—Ç –ø—Ä–æ–±–ª–µ–º—ã**

---

## üõ†Ô∏è –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ

### Stack trace (Q3):

```
1. SQL –ø–∞—Ä—Å–µ—Ä —Å–æ–∑–¥–∞–µ—Ç: $match: {$and: ["kind": {$eq: #0}, "commit.operation": {$eq: #1}]}
2. Executor –≤—ã–ø–æ–ª–Ω—è–µ—Ç full_scan
3. –ü—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º
4. –ü—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ "commit.operation" –ø–æ–ª—É—á–∞–µ—Ç nullptr
5. boost::intrusive_ptr::operator->() –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç assertion
6. SIGABRT
```

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã nullptr:

1. **–î–æ—Å—Ç—É–ø –∫ –≤–ª–æ–∂–µ–Ω–Ω–æ–º—É –ø–æ–ª—é –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç nullptr** –≤–º–µ—Å—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è
2. –§—É–Ω–∫—Ü–∏—è `document_t::get()` –¥–ª—è –ø—É—Ç–∏ `"commit.operation"` –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
3. –û–ø–µ—Ä–∞—Ç–æ—Ä —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ —É–º–µ–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å JSON path'–∞–º–∏
4. –†–µ–∑—É–ª—å—Ç–∞—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è

---

## üîß –†–µ—à–µ–Ω–∏—è

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –≤ —Ç–µ—Å—Ç–∞—Ö):

–£–±—Ä–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–ª—è –∏–∑ –∑–∞–ø—Ä–æ—Å–æ–≤:
```sql
-- –ë—ã–ª–æ:
WHERE kind = 'commit' AND "commit.operation" = 'create'

-- –°—Ç–∞–ª–æ:
WHERE kind = 'commit'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.

---

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π):

#### 1. –î–ª—è document (B-tree) storage:

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ —É–º–µ–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–ª—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

**–†–µ—à–µ–Ω–∏–µ:**
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `document_t::get_nested(path)` –¥–ª—è JSON path'–æ–≤
- –û–±–Ω–æ–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ç–æ—á–µ—á–Ω–æ–π –Ω–æ—Ç–∞—Ü–∏–∏ –≤ document accessor'–∞—Ö

**–ü—Ä–∏–º–µ—Ä:**
```cpp
// –ë—ã–ª–æ:
auto value = doc->get("commit.operation"); // –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

// –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
auto commit = doc->get_dict("/commit");
auto operation = commit->get_string("/operation");
```

#### 2. –î–ª—è document_table storage:

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞–¥–∞–µ—Ç –ø—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–º –ø–æ–ª—è–º, —Ö–æ—Ç—è –∫–æ–ª–æ–Ω–∫–∏ –µ—Å—Ç—å.

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫ `full_scan` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º —Å —Ç–æ—á–∫–∞–º–∏ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `data_chunk_t::value()` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è `"commit.operation"`
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É nullptr –≤ filter expressions

#### 3. –î–ª—è executor (–æ–±—â–µ–µ):

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ nullptr –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç gracefully.

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ nullptr –ø–µ—Ä–µ–¥ —Ä–∞–∑—ã–º–µ–Ω–æ–≤–∞–Ω–∏–µ–º
- –í–æ–∑–≤—Ä–∞—â–∞—Ç—å false –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –µ—Å–ª–∏ –ø–æ–ª–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å warning –≤–º–µ—Å—Ç–æ crash

---

## üìä –û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –í—Ä–µ–º—è | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|-----------|-----------|-------|-----------|
| document::get_nested() | –°—Ä–µ–¥–Ω—è—è | 2-4 —á–∞—Å–∞ | –í—ã—Å–æ–∫–∏–π |
| Filter operators nullptr checks | –ù–∏–∑–∫–∞—è | 1-2 —á–∞—Å–∞ | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| document_table filter fix | –°—Ä–µ–¥–Ω—è—è | 2-3 —á–∞—Å–∞ | –í—ã—Å–æ–∫–∏–π |
| GROUP BY nested fields | –í—ã—Å–æ–∫–∞—è | 4-6 —á–∞—Å–æ–≤ | –°—Ä–µ–¥–Ω–∏–π |
| DISTINCT support | –í—ã—Å–æ–∫–∞—è | 6-8 —á–∞—Å–æ–≤ | –ù–∏–∑–∫–∏–π |

---

## üéØ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–æ–≤

### –†–∞–±–æ—Ç–∞—é—â–∏–µ —Ç–µ—Å—Ç—ã (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã):

| Test | Query | document | document_table | Speedup |
|------|-------|----------|----------------|---------|
| **0** | INSERT | 99ms | 4,683ms | 47.3x |
| **1** | GROUP BY kind | 7ms | 338ms | 48.3x |
| **3** | WHERE kind | 3ms | 109ms | 36.3x |
| **4** | SELECT did, kind | 382ms | 440ms | 1.2x |
| **5** | MIN + GROUP BY did | 311ms | 706ms | 2.3x |

‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã **—É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ö–æ–¥—è—Ç** —Å —É–ø—Ä–æ—â–µ–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏!

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ç–µ–∫—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

1. **–ò–∑–±–µ–≥–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π** –≤ WHERE –∏ GROUP BY –¥–ª—è document storage
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ–ª—è –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è** (`did`, `kind`, `time_us`)
3. **–î–ª—è document_table**: –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–ª—è —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –ø—Ä–æ–µ–∫—Ü–∏–∏ (SELECT), –Ω–æ –Ω–µ –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ö

### –î–ª—è –±—É–¥—É—â–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π:

1. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1**: –ò—Å–ø—Ä–∞–≤–∏—Ç—å nullptr crash (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏)
2. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `get_nested()` –¥–ª—è document storage
3. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3**: –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–º –ø–æ–ª—è–º –≤ document_table
4. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ DISTINCT –∏ —Å–ª–æ–∂–Ω—ã—Ö –∞–≥—Ä–µ–≥–∞—Ü–∏–π

---

## üèÅ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ INSERT –≤ –æ–±–∞ storage
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å –ø–æ–ª—è–º–∏ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è
- ‚úÖ GROUP BY, WHERE, MIN/MAX –Ω–∞ –ø—Ä–æ—Å—Ç—ã—Ö –ø–æ–ª—è—Ö
- ‚úÖ Projection –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –ø–æ–ª–µ–π

### –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚ùå WHERE —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ ‚Üí CRASH
- ‚ùå GROUP BY —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ ‚Üí –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚ùå COUNT(DISTINCT) ‚Üí –Ω–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ (–≤–æ–∑–º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ JSONBench:
**5 –∏–∑ 6 —Ç–µ—Å—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç** —Å —É–ø—Ä–æ—â–µ–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ (–±–µ–∑ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π).

–≠—Ç–æ —Ö–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è baseline —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏!

